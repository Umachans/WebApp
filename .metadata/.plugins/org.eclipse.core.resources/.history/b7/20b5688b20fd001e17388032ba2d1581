package com.example.demo.entity;

import java.time.LocalDateTime;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Data;


//DBからとってきた情報を保管するクラス
@Entity //このクラスを示す@
@Table(name="user_info2")//どのテーブルとリンクしているか
@Data //getter/setterの役割がある
@AllArgsConstructor
public class UserInfo {
	//フィールド名
	
	/*ログインID：primarykey*/
	@Id
	@Column(name="login_id")//テーブルのフィールド名とフィールド名が違う時は@Columnで紐付ける
	private String loginId;
	/*パスワード*/
	/*DBの名前とJavaの変数と同じ名前だから自動的に入ってくる*/
	private String password;
	/*ログイン失敗回数*/
	@Id
	@Column(name="login_failure_count")
	private int loginFailureCount=0;
	
	/*アカウントロック日時*/
	@Column(name="account_locked_time")
	private LocalDateTime accountLockedTime;
	
	/*利用可能か(ture:利用可能)*/
	@Column(name="is_disabled")
	private boolean isDisabled;
	
	public UserInfo() {
		
	}
	
	
	/*ログイン失敗回数をインクリメントする*/
	public UserInfo incrementLoginFailureCount() {
		return new UserInfo(loginId,password, ++loginFailureCount,accountLockedTime,isDisabled);
	}
	/*ログイン失敗回数をリセットする
	 * @return ログイン失敗回数がリセットされたUserInfo
	 * */
	
	public UserInfo resetLoginFailureInfo() {
		return new UserInfo(loginId,password,0,null,isDisabled);
	}
	
	/*アカウント状態を更新する
	 * 
	 *@return ログイン失敗回数、アカウントロック日時が更新されたUserInfo
	 * */
	
	public UserInfo updateAccountLocked() {
		return new UserInfo(loginId,password,0,LocalDateTime.now(),isDisabled);
	}
	
	
	
	

}
